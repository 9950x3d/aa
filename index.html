<!DOCTYPE html>

<html lang="ko">



<head>

<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ìŒ“ê¸°ë‚˜ë¬´ ë¬¸ì œ í’€ê¸° ê²Œì„</title>

<script src="https://cdn.tailwindcss.com"></script>

<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">

<style>

body {

font-family: 'Noto Sans KR', sans-serif;

transition: background-color 0.5s ease-in-out;

}



/* ë‚œì´ë„ë³„ ë°°ê²½ìƒ‰ */

.bg-easy {

background-color: #e6f7ff;

}



.bg-normal {

background-color: #f6ffed;

}



.bg-hard {

background-color: #fff1f0;

}



/* í™”ë©´ ì „í™˜ íš¨ê³¼ */

.screen {

transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;

}



.screen.hidden {

opacity: 0;

transform: scale(0.95);

pointer-events: none;

position: absolute;

}

#draw-canvas {

position: absolute;

top: 0;

left: 0;

width: 100%;

height: 100%;

cursor: crosshair;

pointer-events: none;

z-index: 5;

touch-action: none;

}



#game-screen {

position: relative;

}



.tool-active {

box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);

}



#draw-canvas.eraser-cursor {

cursor: none;

}



#eraser-indicator {

position: fixed; /* âœ¨ absolute â†’ fixed */

border: 3px solid #ff6b6b;

border-radius: 50%;

pointer-events: none;

display: none;

z-index: 9999;

background-color: rgba(255, 107, 107, 0.2);

transform: translate(-50%, -50%); /* âœ¨ ì¤‘ì•™ ì •ë ¬ */

}



/* âœ¨ ë²„íŠ¼ì´ ìˆëŠ” ëª¨ë“  ìš”ì†Œ */

#game-screen button,

#game-screen input,

#game-screen h2,

#game-screen h3,

#game-screen p {

position: relative;

z-index: 10;

}

</style>

</head>



<body class="bg-gray-100 flex items-center justify-center min-h-screen">

<div class="container mx-auto p-4 max-w-4xl w-full">



<!-- ì‹œì‘ í™”ë©´ -->

<div id="start-screen" class="screen bg-white p-8 rounded-2xl shadow-lg text-center">

<h1 class="text-4xl font-bold mb-4 text-gray-800">ìŒ“ê¸°ë‚˜ë¬´ ë¬¸ì œ í’€ê¸° ê²Œì„</h1>

<div class="text-left max-w-2xl mx-auto bg-gray-50 p-6 rounded-lg">

<h2 class="text-2xl font-bold mb-4 text-center text-indigo-600">ğŸ“œ ê²Œì„ ê·œì¹™</h2>

<ul class="list-decimal list-inside space-y-3 text-gray-700">

<li><span class="font-bold">'ê²Œì„ ì‹œì‘'</span> ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ìŒ“ê¸°ë‚˜ë¬´ì˜ <span

class="text-blue-500 font-semibold">ì•, ì˜¤ë¥¸ìª½, ìœ„</span>ì—ì„œ ë³¸ ëª¨ìŠµì´ ë‚˜ì˜µë‹ˆë‹¤. ë™ì‹œì— ì´ˆì‹œê³„ê°€ ì‹œì‘ë¼ìš”.</li>

<li>ë¬¸ì œë¥¼ ë³´ê³  ì‹¤ì œ ìŒ“ê¸°ë‚˜ë¬´ë¡œ ëª¨ì–‘ì„ ë§Œë“¤ì–´ ë³´ì„¸ìš”. (ì„ íƒ ì‚¬í•­)<br>

<a href="https://www.algeomath.kr/kids/algeomath/poly/make.do" target="_blank"

class="text-blue-600 hover:text-blue-800 underline text-sm">

ğŸ”— ì•Œì§€ì˜¤ë§¤ìŠ¤ì—ì„œ ì…ì²´ë„í˜• ë§Œë“¤ê¸°

</a>

</li>

<li>ëª¨ì–‘ì„ ì•Œì•„ëƒˆë‹¤ë©´, í•„ìš”í•œ <span class="font-bold text-red-500">ìŒ“ê¸°ë‚˜ë¬´ì˜ ì´ ê°œìˆ˜</span>ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.</li>

<li>ê°œìˆ˜ë¥¼ ì…ë ¥í•˜ê³  'ì •ë‹µ í™•ì¸' ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì‹œê°„ì´ ë©ˆì¶”ê³ , <span class="font-bold text-green-600">ê°€ëŠ¥í•œ ë²”ìœ„</span>ì™€ ì ìˆ˜ê°€

ê³µê°œë©ë‹ˆë‹¤.</li>

<li>ì ìˆ˜ëŠ” <span class="font-bold">100ì </span>ì—ì„œ ì‹œì‘í•´ì„œ, <span class="font-bold">2ì´ˆë§ˆë‹¤ 1ì </span>ì”© ì¤„ì–´ë“¤ì–´ìš”.

</li>

<li>ë¬¸ì œëŠ” ì´ <span class="font-bold">10ë¬¸ì œ</span>ê°€ ë‚œì´ë„ë³„ë¡œ ë‚˜ì˜µë‹ˆë‹¤.</li>

</ul>

</div>

<div class="mt-8">

<h3 class="text-2xl font-bold mb-4 text-gray-800">ë‚œì´ë„ë¥¼ ì„ íƒí•˜ì„¸ìš”</h3>

<div class="grid grid-cols-1 md:grid-cols-3 gap-4 max-w-2xl mx-auto">

<button data-difficulty="easy"

class="difficulty-btn bg-green-500 hover:bg-green-600 text-white font-bold py-4 px-6 rounded-lg text-lg transition-transform transform hover:scale-105">

ğŸ˜Š ì‰¬ì›€<br>

<span class="text-sm">(3Ã—3 í¬ê¸°)</span>

</button>

<button data-difficulty="normal"

class="difficulty-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-6 rounded-lg text-lg transition-transform transform hover:scale-105">

ğŸ¤” ì¤‘ê°„<br>

<span class="text-sm">(4Ã—4 í¬ê¸°)</span>

</button>

<button data-difficulty="hard"

class="difficulty-btn bg-red-500 hover:bg-red-600 text-white font-bold py-4 px-6 rounded-lg text-lg transition-transform transform hover:scale-105">

ğŸ˜¤ ì–´ë ¤ì›€<br>

<span class="text-sm">(5Ã—5 í¬ê¸°)</span>

</button>

</div>

</div>

</div>



<!-- ë¡œë”© í™”ë©´ -->

<div id="loading-screen" class="screen hidden bg-white p-8 rounded-2xl shadow-lg text-center">

<div class="flex flex-col items-center justify-center min-h-[400px]">

<div class="animate-spin rounded-full h-16 w-16 border-b-4 border-indigo-600 mb-6"></div>

<h2 class="text-3xl font-bold text-gray-800 mb-2">ë¬¸ì œë¥¼ ë§Œë“¤ê³  ìˆìŠµë‹ˆë‹¤...</h2>

<p class="text-gray-600">ìµœì†Œ/ìµœëŒ€ ê°œìˆ˜ë¥¼ ê³„ì‚° ì¤‘ì…ë‹ˆë‹¤</p>

</div>

</div>



<!-- ê²Œì„ í™”ë©´ -->

<div id="game-screen" class="screen hidden bg-white p-8 rounded-2xl shadow-lg">

<canvas id="draw-canvas"></canvas>

 <div id="eraser-indicator"></div> 

<div class="flex justify-between items-center mb-6">

<div class="flex items-center gap-4">

<button id="home-btn"

class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition-transform transform hover:scale-105">ğŸ 

í™ˆ</button>

<h2 id="question-counter" class="text-2xl font-bold text-gray-700">ë¬¸ì œ 1 / 10</h2>

<div class="flex gap-2 ml-4">

<button id="draw-btn"

class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-3 rounded-lg text-sm">

ğŸ–Šï¸ ì“°ê¸°

</button>

<button id="draw-off-btn"

class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-3 rounded-lg text-sm tool-active">

âŒ ë„ê¸°

</button>

<button id="erase-btn"

class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-3 rounded-lg text-sm">

âœï¸ ì§€ìš°ê°œ

</button>

<button id="clear-btn"

class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-3 rounded-lg text-sm">

ğŸ—‘ï¸ ì´ˆê¸°í™”

</button>

</div></div>

<div class="text-right">

<p class="text-lg text-gray-500">ê±¸ë¦° ì‹œê°„</p>

<p id="timer" class="text-3xl font-bold text-red-500">0ì´ˆ</p>

</div>

</div>



<div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">

<div class="bg-gray-50 p-4 rounded-lg">

<h3 class="text-xl font-bold mb-3 text-blue-600">[ ìœ„ì—ì„œ ë³¸ ëª¨ì–‘ ]</h3>

<div id="top-view" class="grid gap-1 max-w-xs mx-auto aspect-square border-2 rounded"></div>

</div>

<div class="bg-gray-50 p-4 rounded-lg">

<h3 class="text-xl font-bold mb-3 text-green-600">[ ì•ì—ì„œ ë³¸ ëª¨ì–‘ ]</h3>

<div id="front-view" class="grid gap-1 max-w-xs mx-auto aspect-square border-2 rounded"></div>

</div>

<div class="bg-gray-50 p-4 rounded-lg">

<h3 class="text-xl font-bold mb-3 text-purple-600">[ ì˜¤ë¥¸ìª½ì—ì„œ ë³¸ ëª¨ì–‘ ]</h3>

<div id="side-view" class="grid gap-1 max-w-xs mx-auto aspect-square border-2 rounded"></div>

</div>

</div>



<div class="mt-8 text-center">

<p class="text-xl mb-3 font-semibold text-gray-800">ìŒ“ê¸°ë‚˜ë¬´ëŠ” ì´ ëª‡ ê°œì¼ê¹Œìš”?</p>

<input id="answer-input" type="number"

class="text-2xl text-center w-48 p-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"

placeholder="ê°œìˆ˜ ì…ë ¥">

<button id="submit-btn"

class="ml-4 bg-green-500 text-white font-bold py-3 px-8 rounded-lg text-xl hover:bg-green-600 transition-transform transform hover:scale-105">ì •ë‹µ

í™•ì¸</button>

<button id="next-question-in-game-btn"

class="ml-4 bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg text-xl hover:bg-indigo-700 transition-transform transform hover:scale-105 hidden">ë‹¤ìŒ

ë¬¸ì œ</button>

</div>

</div>



<!-- ê²°ê³¼ í™”ë©´ -->

<div id="result-screen" class="screen hidden bg-white p-8 rounded-2xl shadow-lg text-center">

<div class="flex justify-between items-center mb-4">

<button id="home-btn-result"

class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition-transform transform hover:scale-105">ğŸ 

í™ˆ</button>

<h2 id="result-title" class="text-4xl font-bold">ì •ë‹µì…ë‹ˆë‹¤!</h2>

<button id="back-to-question-btn"

class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-transform transform hover:scale-105">ğŸ“

ë¬¸ì œ ë³´ê¸°</button>

</div>



<div class="max-w-2xl mx-auto space-y-6">

<div class="grid grid-cols-2 gap-4">

<div class="bg-gray-50 p-4 rounded-lg">

<p class="text-gray-600">ê±¸ë¦° ì‹œê°„</p>

<p id="result-time" class="font-bold text-2xl text-red-500"></p>

</div>

<div class="bg-gray-50 p-4 rounded-lg">

<p class="text-gray-600">íšë“ ì ìˆ˜</p>

<p id="result-score" class="font-bold text-2xl text-indigo-600"></p>

</div>

</div>



<div class="bg-blue-50 border-2 border-blue-400 p-6 rounded-lg">

<p class="text-gray-600 mb-2">ë‚˜ì˜ ë‹µ</p>

<p id="my-answer" class="font-bold text-3xl text-blue-700 mb-4"></p>

</div>



<div class="bg-green-100 border-2 border-green-400 p-6 rounded-lg">

<p class="text-gray-600 mb-2">ê°€ëŠ¥í•œ ë²”ìœ„</p>

<p id="correct-range" class="font-bold text-3xl text-green-700"></p>

<p id="range-explanation" class="text-sm text-gray-600 mt-2"></p>

</div>

</div>



<button id="next-btn"

class="mt-8 bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg text-xl hover:bg-indigo-700 transition-transform transform hover:scale-105">ë‹¤ìŒ

ë¬¸ì œ</button>

</div>



<!-- ìµœì¢… ì ìˆ˜ í™”ë©´ -->

<div id="final-screen" class="screen hidden bg-white p-8 rounded-2xl shadow-lg text-center">

<h2 class="text-4xl font-bold mb-4 text-gray-800">ğŸ‰ ê²Œì„ ì¢…ë£Œ!</h2>

<p class="text-xl text-gray-600 mb-6">ëª¨ë“  ë¬¸ì œë¥¼ í‘¸ì…¨ìŠµë‹ˆë‹¤. ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤!</p>

<div class="bg-indigo-50 p-6 rounded-lg max-w-sm mx-auto">

<p class="text-lg text-indigo-800">ë‚˜ì˜ ìµœì¢… ì ìˆ˜</p>

<p id="final-score" class="text-6xl font-bold text-indigo-600 my-4"></p>

</div>

<button id="restart-btn"

class="mt-8 bg-green-500 text-white font-bold py-3 px-8 rounded-lg text-xl hover:bg-green-600 transition-transform transform hover:scale-105">ë‹¤ì‹œí•˜ê¸°</button>

</div>



</div>



<script>

// DOM ìš”ì†Œ

const screens = {

start: document.getElementById('start-screen'),

loading: document.getElementById('loading-screen'),

game: document.getElementById('game-screen'),

result: document.getElementById('result-screen'),

final: document.getElementById('final-screen')

};



const difficultyBtns = document.querySelectorAll('.difficulty-btn');

const questionCounter = document.getElementById('question-counter');

const timerEl = document.getElementById('timer');

const answerInput = document.getElementById('answer-input');

const submitBtn = document.getElementById('submit-btn');

const nextBtn = document.getElementById('next-btn');

const restartBtn = document.getElementById('restart-btn');

const homeBtns = [document.getElementById('home-btn'), document.getElementById('home-btn-result')];

const backToQuestionBtn = document.getElementById('back-to-question-btn');

const nextQuestionInGameBtn = document.getElementById('next-question-in-game-btn');



const viewContainers = {

top: document.getElementById('top-view'),

front: document.getElementById('front-view'),

side: document.getElementById('side-view')

};



const resultEls = {

title: document.getElementById('result-title'),

time: document.getElementById('result-time'),

score: document.getElementById('result-score'),

myAnswer: document.getElementById('my-answer'),

correctRange: document.getElementById('correct-range'),

rangeExplanation: document.getElementById('range-explanation')

};

const finalScoreEl = document.getElementById('final-score');



// ê²Œì„ ìƒíƒœ

let currentProblemIndex = 0;

let shuffledProblems = [];

let totalScore = 0;

let timerInterval;

let seconds = 0;

let currentDifficulty = 'normal';

let isSubmitted = false; // ì œì¶œ ì—¬ë¶€ ì¶”ì 



let isDrawing = false;

let drawMode = 'draw';

let canvas, ctx;



function switchScreen(screenName) {

Object.values(screens).forEach(screen => {

if (screen.id.replace('-screen', '') !== screenName) {

screen.classList.add('hidden');

}

});

if (screens[screenName]) {

screens[screenName].classList.remove('hidden');

}

}



// ë‚œì´ë„ë³„ ë¬¸ì œ ìƒì„± (ì¼ê´€ì„± ê²€ì¦ ê°•í™”)

function generateProblemByDifficulty(difficulty) {

let size, maxHeight, density;



switch (difficulty) {

case 'easy':

size = 3;

maxHeight = 3;

density = 0.6;

break;

case 'normal':

size = 4;

maxHeight = 4;

density = 0.5;

break;

case 'hard':

size = 5;

maxHeight = 5;

density = 0.4;

break;

}



let attempts = 0;

while (attempts < 50) {

attempts++;



// 1. topView ìƒì„±

const topView = Array(size).fill(0).map(() => Array(size).fill(0));

for (let r = 0; r < size; r++) {

for (let c = 0; c < size; c++) {

if (Math.random() < density) {

topView[r][c] = 1;

}

}

}



const hasBlock = topView.some(row => row.some(cell => cell === 1));

if (!hasBlock) continue;



const blockCount = topView.flat().filter(cell => cell === 1).length;

const maxAllowed = Math.floor(size * size * 0.75); // ì „ì²´ì˜ 75%ê¹Œì§€ë§Œ í—ˆìš©

if (blockCount > maxAllowed) continue;



// 2. frontView ìƒì„±

const frontView = Array(size).fill(0);

for (let c = 0; c < size; c++) {

let hasBlockInCol = false;

for (let r = 0; r < size; r++) {

if (topView[r][c] === 1) {

hasBlockInCol = true;

break;

}

}

if (hasBlockInCol) {

frontView[c] = Math.floor(Math.random() * maxHeight) + 1;

}

}



// 3. ê°€ëŠ¥í•œ sideViewë“¤ ì°¾ê¸°

const possibleResults = findAllPossibleSideViews(topView, frontView);



if (possibleResults.length === 0) continue;



// 4. ëœë¤í•˜ê²Œ í•˜ë‚˜ ì„ íƒ

const selected = possibleResults[Math.floor(Math.random() * possibleResults.length)];



// 5. ìµœì†Œ/ìµœëŒ€ê°’ì´ ì ë‹¹í•œì§€ ì²´í¬ (ë„ˆë¬´ ë‹¨ìˆœí•œ ë¬¸ì œ ì œì™¸)

if (selected.maxBlocks - selected.minBlocks >= 0) {

return {

topView: topView,

frontView: frontView,

sideView: selected.sideView,

minBlocks: selected.minBlocks,

maxBlocks: selected.maxBlocks

};

}

}



// ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ ë¬¸ì œ

const topView = Array(size).fill(0).map(() => Array(size).fill(0));

topView[0][0] = 1;

const frontView = Array(size).fill(0);

frontView[0] = 1;

const sideView = Array(size).fill(0);

sideView[0] = 1;

return { topView, frontView, sideView, minBlocks: 1, maxBlocks: 1 };

}



// ìµœëŒ€ê°’ ê³„ì‚° (ì •í™•í•¨)

function calculateMaxBlocks(topView, frontView, sideView) {

const size = topView.length;

let total = 0;



for (let r = 0; r < size; r++) {

for (let c = 0; c < size; c++) {

if (topView[r][c] === 1) {

total += Math.min(frontView[c], sideView[r]);

}

}

}

return total;

}



function findAllPossibleSideViews(topView, frontView) {

const size = topView.length;

const possibleConfigs = [];



// topViewì˜ ê° í–‰/ì—´ì— ë¸”ë¡ì´ ìˆëŠ”ì§€ ë¯¸ë¦¬ ê³„ì‚°í•˜ì—¬ ìºì‹±

// ì´ ì •ë³´ëŠ” sideView, frontViewê°€ 0ì´ ë˜ì–´ì•¼ í•˜ëŠ”ì§€ íŒë‹¨í•˜ëŠ” ë° ì‚¬ìš©ë¨

const topViewHasBlockInRow = Array(size).fill(false);

const topViewHasBlockInCol = Array(size).fill(false);

for (let r = 0; r < size; r++) {

for (let c = 0; c < size; c++) {

if (topView[r][c] === 1) {

topViewHasBlockInRow[r] = true;

topViewHasBlockInCol[c] = true;

}

}

}



function backtrack(r, c, grid) {

if (r === size) {

// ëª¨ë“  ì…€ì„ ì±„ì› ì„ ë•Œ ìµœì¢… ìœ íš¨ì„± ê²€ì‚¬



// 1. frontView ì¡°ê±´ ë§Œì¡± ì—¬ë¶€ ê²€ì‚¬ (ê¸°ì¡´ ë¡œì§)

let frontViewSatisfied = true;

for (let col = 0; col < size; col++) {

let colMax = 0;

for (let row = 0; row < size; row++) {

colMax = Math.max(colMax, grid[row][col]);

}

if (colMax !== frontView[col]) {

frontViewSatisfied = false;

break;

}

}



if (frontViewSatisfied) {

// frontView ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ sideViewë¥¼ ê³„ì‚°

const calculatedSideView = [];

for (let row = 0; row < size; row++) {

let rowMax = 0;

for (let col = 0; col < size; col++) {

rowMax = Math.max(rowMax, grid[row][col]);

}

calculatedSideView[row] = rowMax;

}



// 2. topViewì™€ frontView, calculatedSideView ê°„ì˜ ì¶”ê°€ ì¼ê´€ì„± ê²€ì‚¬

let allViewsConsistent = true;



// 2-1. topViewì—ì„œ ë¸”ë¡ì´ ì—†ëŠ” í–‰ì˜ calculatedSideView ë†’ì´ê°€ 0ì´ ì•„ë‹Œ ê²½ìš° (ì§ˆë¬¸ìë‹˜ ë¬¸ì œ ì¼€ì´ìŠ¤)

// topViewHasBlockInRowë¥¼ ì‚¬ìš©í•˜ì—¬ íš¨ìœ¨ì ìœ¼ë¡œ ê²€ì‚¬

for (let row = 0; row < size; row++) {

if (!topViewHasBlockInRow[row] && calculatedSideView[row] !== 0) {

allViewsConsistent = false;

break;

}

}

if (!allViewsConsistent) {

return; // ëª¨ìˆœì´ë¯€ë¡œ ì´ ë°°ì¹˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ

}



// 2-2. topViewì—ì„œ ë¸”ë¡ì´ ì—†ëŠ” ì—´ì˜ frontView ë†’ì´ê°€ 0ì´ ì•„ë‹Œ ê²½ìš°

// (ì´ ë¶€ë¶„ì€ frontViewSatisfied ê²€ì‚¬ ì´ì „ì— ì´ë¯¸ ê±¸ëŸ¬ì§€ê±°ë‚˜, frontView ìƒì„± ì‹œ ì´ë¯¸ ê³ ë ¤ë˜ì–´ì•¼ í•¨)

// í•˜ì§€ë§Œ ë°©ì–´ì ìœ¼ë¡œ ë‹¤ì‹œ í•œë²ˆ ê²€ì‚¬ (ì—¬ê¸°ì„œëŠ” frontViewê°€ ê³ ì •ëœ ì…ë ¥ê°’ì´ë¯€ë¡œ, ì´ ê²€ì‚¬ê°€ ì‹¤íŒ¨í•˜ë©´

// ì• ì´ˆì— topViewì™€ frontView ì…ë ¥ ìì²´ê°€ ëª¨ìˆœëœë‹¤ëŠ” ì˜ë¯¸)

for (let col = 0; col < size; col++) {

if (!topViewHasBlockInCol[col] && frontView[col] !== 0) {

allViewsConsistent = false;

break;

}

}

if (!allViewsConsistent) {

return; // ëª¨ìˆœì´ë¯€ë¡œ ì´ ë°°ì¹˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ

}



// ëª¨ë“  ê²€ì‚¬ë¥¼ í†µê³¼í•œ ê²½ìš°ì—ë§Œ possibleConfigsì— ì¶”ê°€

let total = 0;

for (let row = 0; row < size; row++) {

for (let col = 0; col < size; col++) {

total += grid[row][col];

}

}



// ë¡œê·¸ ì¶”ê°€: ê° ìœ íš¨í•œ ë°°ì¹˜ ì¶œë ¥

// console.log('ìœ íš¨í•œ ë°°ì¹˜:', JSON.stringify(grid), 'sideView:', calculatedSideView, 'total:', total);



possibleConfigs.push({

sideView: calculatedSideView,

total: total

});

}

return;

}



const nextC = (c + 1) % size;

const nextR = nextC === 0 ? r + 1 : r;



if (topView[r][c] === 0) {

// topViewì— ë¸”ë¡ì´ ì—†ìœ¼ë©´ í•´ë‹¹ ì¹¸ì˜ ë†’ì´ëŠ” 0

grid[r][c] = 0;

backtrack(nextR, nextC, grid);

} else {

// topViewì— ë¸”ë¡ì´ ìˆìœ¼ë©´ ë†’ì´ëŠ” 1 ì´ìƒ

// í•´ë‹¹ ì—´ì˜ frontView[c] ë†’ì´ë¥¼ ë„˜ì„ ìˆ˜ ì—†ìŒ

const maxH = frontView[c];

for (let h = 1; h <= maxH; h++) {

// (ì„ íƒ ì‚¬í•­: ì¬ê·€ ì¤‘ê°„ì— ë” ë¹ ë¥´ê²Œ ê°€ì§€ì¹˜ê¸°)

// í˜„ì¬ r, c ìœ„ì¹˜ì— h ë†’ì´ë¥¼ ë†“ì•˜ì„ ë•Œ,

// í˜„ì¬ê¹Œì§€ ì±„ì›Œì§„ í–‰ (r)ì˜ ìµœëŒ€ ë†’ì´ê°€ topViewHasBlockInRow[r]ì™€ ëª¨ìˆœë˜ì§€ ì•ŠëŠ”ì§€

// ê·¸ë¦¬ê³  í˜„ì¬ê¹Œì§€ ì±„ì›Œì§„ ì—´ (c)ì˜ ìµœëŒ€ ë†’ì´ê°€ frontView[c]ì™€ ëª¨ìˆœë˜ì§€ ì•ŠëŠ”ì§€

// ì´ ë‹¨ê³„ì—ì„œ ê²€ì‚¬í•˜ë©´ ë” ë¹ ë¥¼ ìˆ˜ ìˆìœ¼ë‚˜, ë³µì¡ë„ê°€ ì¦ê°€í•˜ê³  ìµœì¢… ê²€ì‚¬ë¡œ ì¶©ë¶„í•  ìˆ˜ ìˆìŒ.

// ì—¬ê¸°ì„œëŠ” ìµœì¢… ê²€ì‚¬ì— ì§‘ì¤‘í•˜ì—¬ ì½”ë“œ ê°„ê²°ì„± ìœ ì§€.



grid[r][c] = h;

backtrack(nextR, nextC, grid);

}

}

}



const grid = Array(size).fill(0).map(() => Array(size).fill(0));

backtrack(0, 0, grid);



// ë¡œê·¸ ì¶”ê°€: ì´ ëª‡ ê°œì˜ ìœ íš¨í•œ ë°°ì¹˜ê°€ ë°œê²¬ë˜ì—ˆëŠ”ì§€

console.log('ì´ ìœ íš¨í•œ ë°°ì¹˜ ê°œìˆ˜:', possibleConfigs.length);



const sideViewMap = new Map();

for (const config of possibleConfigs) {

const key = JSON.stringify(config.sideView);

if (!sideViewMap.has(key)) {

sideViewMap.set(key, {

sideView: config.sideView,

totals: []

});

}

sideViewMap.get(key).totals.push(config.total);

}



const results = [];

for (const [key, data] of sideViewMap) {

results.push({

sideView: data.sideView,

minBlocks: Math.min(...data.totals),

maxBlocks: Math.max(...data.totals)

});

// ë¡œê·¸ ì¶”ê°€: ê° sideViewë³„ ìµœì†Œ/ìµœëŒ€

console.log('sideView:', data.sideView, 'min:', Math.min(...data.totals), 'max:', Math.max(...data.totals));

}



return results;

}



function startGame() {

document.body.className = `flex items-center justify-center min-h-screen bg-${currentDifficulty}`;



// ë¡œë”© í™”ë©´ í‘œì‹œ

switchScreen('loading');



// ë¹„ë™ê¸°ë¡œ ë¬¸ì œ ìƒì„± (UI ë¸”ë¡œí‚¹ ë°©ì§€)

setTimeout(() => {

shuffledProblems = [];

const questionTypes = ['total', 'total', 'total', 'max', 'min', 'min', 'min', 'min', 'max', 'max'];



// ì…”í”Œ

for (let i = questionTypes.length - 1; i > 0; i--) {

const j = Math.floor(Math.random() * (i + 1));

[questionTypes[i], questionTypes[j]] = [questionTypes[j], questionTypes[i]];

}



for (let i = 0; i < 10; i++) {

const problem = generateProblemByDifficulty(currentDifficulty);



shuffledProblems.push({

topView: problem.topView,

frontView: problem.frontView,

sideView: problem.sideView,

minBlocks: problem.minBlocks,

maxBlocks: problem.maxBlocks,

type: questionTypes[i]

});

}



currentProblemIndex = 0;

totalScore = 0;

loadQuestion();

switchScreen('game');

}, 100);

}



function loadQuestion() {

answerInput.value = '';

answerInput.disabled = false;

submitBtn.disabled = false;

submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');

isSubmitted = false;

answerInput.focus();



nextQuestionInGameBtn.classList.add('hidden');



const problem = shuffledProblems[currentProblemIndex];

console.log('topView:', problem.topView);

console.log('frontView:', problem.frontView);

console.log('sideView:', problem.sideView);

console.log('min:', problem.minBlocks, 'max:', problem.maxBlocks);

questionCounter.textContent = `ë¬¸ì œ ${currentProblemIndex + 1} / 10`;



const questionTextEl = document.querySelector('#game-screen .text-center p.text-xl');

if (problem.type === 'min') {

questionTextEl.textContent = 'ìŒ“ê¸°ë‚˜ë¬´ëŠ” ìµœì†Œ ëª‡ ê°œì¼ê¹Œìš”?';

} else if (problem.type === 'max') {

questionTextEl.textContent = 'ìŒ“ê¸°ë‚˜ë¬´ëŠ” ìµœëŒ€ ëª‡ ê°œì¼ê¹Œìš”?';

} else {

questionTextEl.textContent = 'ìŒ“ê¸°ë‚˜ë¬´ëŠ” ì´ ëª‡ ê°œì¼ê¹Œìš”?';

}



// âœ¨ requestAnimationFrame ì¶”ê°€

requestAnimationFrame(() => {

renderTopView(viewContainers.top, problem.topView);

renderFrontView(viewContainers.front, problem.frontView);

renderRightSideView(viewContainers.side, problem.sideView);



// âœ¨ ìº”ë²„ìŠ¤ ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë“±ë¡

initCanvas();

if (ctx) {

ctx.clearRect(0, 0, canvas.width, canvas.height);



canvas.removeEventListener('mousedown', startDrawing);

canvas.removeEventListener('mousemove', draw);

canvas.removeEventListener('mouseup', stopDrawing);

canvas.removeEventListener('mouseout', stopDrawing);



canvas.addEventListener('mousedown', startDrawing);

canvas.addEventListener('mousemove', draw);

canvas.addEventListener('mouseup', stopDrawing);

canvas.addEventListener('mouseout', stopDrawing);



canvas.removeEventListener('touchstart', handleTouchStart);

canvas.removeEventListener('touchmove', handleTouchMove);

canvas.removeEventListener('touchend', handleTouchEnd);



canvas.addEventListener('touchstart', handleTouchStart);

canvas.addEventListener('touchmove', handleTouchMove);

canvas.addEventListener('touchend', handleTouchEnd);

}



// âœ¨ ì´ˆê¸° ìƒíƒœ: ë„ê¸° í™œì„±í™”

drawOffBtn.classList.add('tool-active');

drawBtn.classList.remove('tool-active');

eraseBtn.classList.remove('tool-active');

canvas.style.pointerEvents = 'none';

});

startTimer();

}



function renderGrid(container, size) {

container.innerHTML = '';

container.style.display = 'grid';

container.style.gridTemplateRows = `repeat(${size}, 1fr)`;

container.style.gridTemplateColumns = `repeat(${size}, 1fr)`;

container.style.gap = '4px';



const cells = [];

for (let i = 0; i < size * size; i++) {

const cell = document.createElement('div');

cell.className = 'bg-gray-200 border-2 border-gray-400';

cell.style.minWidth = '20px';

cell.style.minHeight = '20px';

container.appendChild(cell);

cells.push(cell);

}

return cells;

}



function renderTopView(container, viewData) {

const size = viewData.length;

const cells = renderGrid(container, size);

for (let r = 0; r < size; r++) {

for (let c = 0; c < size; c++) {

if (viewData[r][c] === 1) {

cells[r * size + c].className = 'bg-yellow-400 border-2 border-yellow-700';

}

}

}

}



function renderFrontView(container, viewData) {

const size = viewData.length;

const cells = renderGrid(container, size);



for (let c = 0; c < size; c++) {

const height = viewData[c];

for (let h = 0; h < height; h++) {

cells[(size - 1 - h) * size + c].className = 'bg-yellow-400 border-2 border-yellow-700';

}

}

}



function renderRightSideView(container, viewData) {

const size = viewData.length;

const cells = renderGrid(container, size);



for (let r = 0; r < size; r++) {

const height = viewData[r];

for (let h = 0; h < height; h++) {

cells[(size - 1 - h) * size + (size - 1 - r)].className = 'bg-yellow-400 border-2 border-yellow-700';

}

}

}



function startTimer() {

seconds = 0;

timerEl.textContent = `${seconds}ì´ˆ`;

clearInterval(timerInterval);

timerInterval = setInterval(() => {

seconds++;

timerEl.textContent = `${seconds}ì´ˆ`;

}, 1000);

}



function stopTimer() {

clearInterval(timerInterval);

}



function handleSubmit() {

if (isSubmitted) return; // ì´ë¯¸ ì œì¶œí–ˆìœ¼ë©´ ë¬´ì‹œ



stopTimer();

isSubmitted = true;



// ì…ë ¥ì°½ê³¼ ë²„íŠ¼ ëª¨ë‘ ë¹„í™œì„±í™”

answerInput.disabled = true;

submitBtn.disabled = true; // ì¶”ê°€

submitBtn.classList.add('opacity-50', 'cursor-not-allowed'); // ì‹œê°ì  í”¼ë“œë°±



nextQuestionInGameBtn.classList.remove('hidden');



const userAnswer = parseInt(answerInput.value, 10);

const problem = shuffledProblems[currentProblemIndex];



let isCorrect;

if (problem.type === 'min') {

isCorrect = userAnswer === problem.minBlocks;

} else if (problem.type === 'max') {

isCorrect = userAnswer === problem.maxBlocks;

} else {

isCorrect = !isNaN(userAnswer) &&

userAnswer >= problem.minBlocks &&

userAnswer <= problem.maxBlocks;

}



let score = 0;

if (isCorrect) {

score = Math.max(0, 100 - Math.floor(seconds / 2));

resultEls.title.textContent = "ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤!";

resultEls.title.className = "text-4xl font-bold text-green-600";

} else {

score = 0;

resultEls.title.textContent = "ğŸ¤” ì•„ì‰¬ì›Œìš”, í‹€ë ¸ìŠµë‹ˆë‹¤.";

resultEls.title.className = "text-4xl font-bold text-red-500";

}

totalScore += score;



resultEls.time.textContent = `${seconds}ì´ˆ`;

resultEls.score.textContent = `${score}ì `;

resultEls.myAnswer.textContent = isNaN(userAnswer) ? "ì…ë ¥ ì•ˆ í•¨" : `${userAnswer}ê°œ`;

if (problem.type === 'min') {

resultEls.correctRange.textContent = `ìµœì†Œ: ${problem.minBlocks}ê°œ`;

resultEls.rangeExplanation.textContent = `ì´ ë¬¸ì œì˜ ìµœì†Œ ê°œìˆ˜ëŠ” ${problem.minBlocks}ê°œì…ë‹ˆë‹¤. (ìµœëŒ€ëŠ” ${problem.maxBlocks}ê°œ)`;

} else if (problem.type === 'max') {

resultEls.correctRange.textContent = `ìµœëŒ€: ${problem.maxBlocks}ê°œ`;

resultEls.rangeExplanation.textContent = `ì´ ë¬¸ì œì˜ ìµœëŒ€ ê°œìˆ˜ëŠ” ${problem.maxBlocks}ê°œì…ë‹ˆë‹¤. (ìµœì†ŒëŠ” ${problem.minBlocks}ê°œ)`;

} else {

resultEls.correctRange.textContent = `${problem.minBlocks}ê°œ ~ ${problem.maxBlocks}ê°œ`;

if (problem.minBlocks === problem.maxBlocks) {

resultEls.rangeExplanation.textContent = `ì´ ë¬¸ì œëŠ” ì •í™•íˆ ${problem.minBlocks}ê°œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤!`;

} else {

resultEls.rangeExplanation.textContent = `ì—¬ëŸ¬ ê°€ì§€ ë°°ì¹˜ê°€ ê°€ëŠ¥í•´ì„œ ${problem.minBlocks}~${problem.maxBlocks}ê°œ ì‚¬ì´ ëª¨ë‘ ì •ë‹µì…ë‹ˆë‹¤!`;

}

}



if (currentProblemIndex === 9) {

nextBtn.textContent = 'ìµœì¢… ê²°ê³¼ ë³´ê¸°'; // result-screenì˜ next-btn

nextQuestionInGameBtn.textContent = 'ìµœì¢… ê²°ê³¼ ë³´ê¸°'; // game-screenì˜ next-question-in-game-btn

} else {

nextBtn.textContent = 'ë‹¤ìŒ ë¬¸ì œ'; // result-screenì˜ next-btn

nextQuestionInGameBtn.textContent = 'ë‹¤ìŒ ë¬¸ì œ'; // game-screenì˜ next-question-in-game-btn

}



switchScreen('result');

}



function handleNext() {

// âœ¨ ì´ ì¤„ ì¶”ê°€

if (ctx) ctx.clearRect(0, 0, canvas.width, canvas.height);



currentProblemIndex++;

if (currentProblemIndex < 10) {

loadQuestion();

switchScreen('game');

} else {

showFinalScore();

}

}



function showFinalScore() {

finalScoreEl.textContent = `${totalScore}ì `;

switchScreen('final');

}



// ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ

difficultyBtns.forEach(btn => {

btn.addEventListener('click', (e) => {

currentDifficulty = e.target.dataset.difficulty;

startGame();

});

});



submitBtn.addEventListener('click', handleSubmit);



answerInput.addEventListener('keydown', (e) => {

if (e.key === 'Enter') {

handleSubmit();

}

});



nextBtn.addEventListener('click', handleNext);



restartBtn.addEventListener('click', () => {

document.body.className = `bg-gray-100 flex items-center justify-center min-h-screen`;

switchScreen('start');

});



// í™ˆ ë²„íŠ¼ ì´ë²¤íŠ¸

homeBtns.forEach(btn => {

btn.addEventListener('click', () => {

if (confirm('í™ˆìœ¼ë¡œ ëŒì•„ê°€ë©´ í˜„ì¬ ê²Œì„ ì§„í–‰ì´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {

stopTimer();

document.body.className = `bg-gray-100 flex items-center justify-center min-h-screen`;

switchScreen('start');

}

});

});



// ë¬¸ì œ ë³´ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸

backToQuestionBtn.addEventListener('click', () => {

// ì´ë¯¸ ì œì¶œëœ ìƒíƒœì´ë¯€ë¡œ nextQuestionInGameBtnì„ ë³´ì—¬ì¤€ë‹¤.

// nextQuestionInGameBtn.classList.remove('hidden'); // ì´ë¯¸ handleSubmitì—ì„œ ì²˜ë¦¬ë¨

switchScreen('game');

});



nextQuestionInGameBtn.addEventListener('click', handleNext); // ê¸°ì¡´ handleNext í•¨ìˆ˜ ì¬í™œìš©



function initCanvas() {

canvas = document.getElementById('draw-canvas');

if (!canvas) return;



ctx = canvas.getContext('2d');

const container = document.getElementById('game-screen');

canvas.width = container.offsetWidth;

canvas.height = container.offsetHeight;



ctx.lineWidth = 3;

ctx.lineCap = 'round';

ctx.strokeStyle = '#FF0000';

}



function startDrawing(e) {

const rect = canvas.getBoundingClientRect();

const x = e.clientX - rect.left;

const y = e.clientY - rect.top;



// âœ¨ ìƒë‹¨ ë²„íŠ¼ ì˜ì—­(ì•½ 100px)ì—ì„œëŠ” ê·¸ë¦¬ê¸° ì°¨ë‹¨

if (y < 100) {

return;

}



isDrawing = true;

ctx.beginPath();

ctx.moveTo(x, y);

}



function draw(e) {

if (!isDrawing) return;



const rect = canvas.getBoundingClientRect();

const x = e.clientX - rect.left;

const y = e.clientY - rect.top;



// âœ¨ ë²„íŠ¼ ì˜ì—­ì—ì„œëŠ” ê·¸ë¦¬ê¸° ì°¨ë‹¨

if (y < 100) {

stopDrawing();

return;

}



ctx.lineTo(x, y);

ctx.stroke();

}

function stopDrawing() {

isDrawing = false;

}



function handleTouchStart(e) {

e.preventDefault();

const touch = e.touches[0];

const mouseEvent = new MouseEvent('mousedown', {

clientX: touch.clientX,

clientY: touch.clientY

});

canvas.dispatchEvent(mouseEvent);



// ì§€ìš°ê°œ í‘œì‹œ ì—…ë°ì´íŠ¸

if (drawMode === 'erase') {

const size = ctx.lineWidth;

eraserIndicator.style.width = size + 'px';

eraserIndicator.style.height = size + 'px';

eraserIndicator.style.left = touch.clientX + 'px';

eraserIndicator.style.top = touch.clientY + 'px';

eraserIndicator.style.display = 'block';

}

}



function handleTouchMove(e) {

e.preventDefault();

const touch = e.touches[0];

const mouseEvent = new MouseEvent('mousemove', {

clientX: touch.clientX,

clientY: touch.clientY

});

canvas.dispatchEvent(mouseEvent);



// ì§€ìš°ê°œ í‘œì‹œ ì—…ë°ì´íŠ¸

if (drawMode === 'erase') {

const size = ctx.lineWidth;

eraserIndicator.style.width = size + 'px';

eraserIndicator.style.height = size + 'px';

eraserIndicator.style.left = touch.clientX + 'px';

eraserIndicator.style.top = touch.clientY + 'px';

}

}



function handleTouchEnd(e) {

e.preventDefault();

const mouseEvent = new MouseEvent('mouseup', {});

canvas.dispatchEvent(mouseEvent);



// ì§€ìš°ê°œ ìˆ¨ê¸°ê¸°

if (drawMode === 'erase') {

eraserIndicator.style.display = 'none';

}

}



// ë²„íŠ¼ ì´ë²¤íŠ¸

const drawBtn = document.getElementById('draw-btn');

const drawOffBtn = document.getElementById('draw-off-btn');

const eraseBtn = document.getElementById('erase-btn');

const clearBtn = document.getElementById('clear-btn');

const eraserIndicator = document.getElementById('eraser-indicator');



// âœ¨ ì“°ê¸° ë²„íŠ¼

drawBtn.addEventListener('click', () => {

drawMode = 'draw';

canvas.style.pointerEvents = 'auto';

canvas.classList.remove('eraser-cursor');

eraserIndicator.style.display = 'none';

drawBtn.classList.add('tool-active');

drawOffBtn.classList.remove('tool-active');

eraseBtn.classList.remove('tool-active');

ctx.strokeStyle = '#FF0000';

ctx.lineWidth = 3;

ctx.globalCompositeOperation = 'source-over';

});



// âœ¨ ë„ê¸° ë²„íŠ¼

drawOffBtn.addEventListener('click', () => {

canvas.style.pointerEvents = 'none';

canvas.classList.remove('eraser-cursor');

eraserIndicator.style.display = 'none';

drawOffBtn.classList.add('tool-active');

drawBtn.classList.remove('tool-active');

eraseBtn.classList.remove('tool-active');

});



// âœ¨ ì§€ìš°ê°œ ë²„íŠ¼

eraseBtn.addEventListener('click', () => {

drawMode = 'erase';

canvas.style.pointerEvents = 'auto';

canvas.classList.add('eraser-cursor');

eraseBtn.classList.add('tool-active');

drawBtn.classList.remove('tool-active');

drawOffBtn.classList.remove('tool-active');

ctx.strokeStyle = '#FFFFFF';

ctx.lineWidth = 20;

ctx.globalCompositeOperation = 'destination-out';

});



// âœ¨ ì´ˆê¸°í™” ë²„íŠ¼

clearBtn.addEventListener('click', () => {

if (confirm('ë©”ëª¨ë¥¼ ëª¨ë‘ ì§€ìš¸ê¹Œìš”?')) {

ctx.clearRect(0, 0, canvas.width, canvas.height);

}

});



// âœ¨ ì§€ìš°ê°œ í‘œì‹œ ì—…ë°ì´íŠ¸

document.addEventListener('mousemove', (e) => {

if (drawMode === 'erase' && canvas.style.pointerEvents === 'auto') {

eraserIndicator.style.display = 'block';



const size = ctx.lineWidth;

eraserIndicator.style.width = size + 'px';

eraserIndicator.style.height = size + 'px';

eraserIndicator.style.left = e.clientX + 'px';

eraserIndicator.style.top = e.clientY + 'px';

} else if (drawMode !== 'erase') {

eraserIndicator.style.display = 'none'; // âœ¨ ì§€ìš°ê°œ ëª¨ë“œ ì•„ë‹ˆë©´ ìˆ¨ê¸°ê¸°

}

});







// ì´ˆê¸° í™”ë©´ í‘œì‹œ

switchScreen('start');

</script>

</body>



</html>


To top

